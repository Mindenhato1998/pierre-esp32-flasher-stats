<!DOCTYPE html>
<html>
<head>
    <title>MQTT Test</title>
    <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
</head>
<body>
    <h1>MQTT Test Client</h1>
    <div id="messages"></div>

    <script>
        const BROKER_URL = 'wss://0c1bf62a21e94682adf340b8a2d3fe04.s1.eu.hivemq.cloud:8884/mqtt';
        const USERNAME = 'pierreflasher';
        const PASSWORD = 'Pierre2k23';

        console.log('Connecting to MQTT...');

        const client = mqtt.connect(BROKER_URL, {
            username: USERNAME,
            password: PASSWORD,
            clean: true
        });

        client.on('connect', function() {
            console.log('Connected to MQTT');

            // Subscribe to status messages
            client.subscribe('pierre/status/+/+', {qos: 0});
            console.log('Subscribed to pierre/status/+/+');
        });

        client.on('message', function(topic, message) {
            const msg = `${new Date().toISOString()} - ${topic}: ${message.toString()}`;
            console.log(msg);

            const div = document.getElementById('messages');
            div.innerHTML += msg + '<br>';
        });

        client.on('error', function(error) {
            console.error('MQTT Error:', error);
        });
    </script>
</body>
</html>